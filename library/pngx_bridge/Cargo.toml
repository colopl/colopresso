[package]
name = "pngx_bridge"
version = "0.0.0"
edition = "2021"
publish = false
license = "GPL-3.0"

[lib]
crate-type = ["staticlib", "cdylib"]
name = "pngx_bridge"

[features]
default = []
rayon = ["dep:rayon", "oxipng/parallel", "imagequant/threads"]
# For WASM builds: use freestanding mode and disable libdeflater (C code)
# to avoid needing a WASM-capable C compiler
wasm-bindgen = ["dep:wasm-bindgen", "oxipng/freestanding", "oxipng/filetime"]

[dependencies]
libc = "0.2"
rayon = { version = "1.11", optional = true }
wasm-bindgen = { version = "0.2", optional = true }
png = "0.17"

[dependencies.oxipng]
version = "10.0.0"
default-features = false
# Use zopfli for compression (pure Rust), avoid libdeflater (requires C compiler)
features = ["zopfli"]

[dependencies.imagequant]
version = "4.4.0"
default-features = false

[build-dependencies]
cbindgen = "0.29.0"
