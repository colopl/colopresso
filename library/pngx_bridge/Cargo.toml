[package]
name = "pngx_bridge"
version = "0.0.0"
edition = "2021"
publish = false
license = "GPL-3.0"

[lib]
crate-type = ["staticlib", "cdylib"]
name = "pngx_bridge"

[features]
default = []
rayon = ["dep:rayon", "oxipng/parallel", "imagequant/threads"]

# WASM builds with stable Rust (no threading)
wasm-bindgen = ["dep:wasm-bindgen", "oxipng/freestanding", "oxipng/filetime"]

# WASM builds with nightly Rust (threading via wasm-bindgen-rayon)
wasm-bindgen-rayon = [
    "dep:wasm-bindgen",
    "dep:wasm-bindgen-rayon",
    "dep:rayon",
    "oxipng/freestanding",
    "oxipng/filetime",
    "oxipng/parallel",
    "imagequant/threads",
]

[dependencies]
rayon = { version = "1.11", optional = true }
wasm-bindgen = { version = "0.2", optional = true }
wasm-bindgen-rayon = { version = "1.3", optional = true }

[dependencies.oxipng]
version = "10.0.0"
default-features = false
features = ["zopfli", "freestanding"]

[dependencies.imagequant]
version = "4.4.0"
default-features = false

[build-dependencies]
cbindgen = "0.29.0"
